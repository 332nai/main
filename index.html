<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sydney Life Hub | æ‚‰å°¼ç”Ÿæ´»æŒ‡å—</title>
    <script src="https://cdn.tailwindcss.com"></script>
    
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif; }
        [x-cloak] { display: none !important; }
        
        .bg-animate {
            background: linear-gradient(-45deg, #ee7752, #e73c7e, #23a6d5, #23d5ab);
            background-size: 400% 400%;
            animation: gradient 15s ease infinite;
        }
        @keyframes gradient {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
    </style>
</head>

<body x-data="authApp()" x-init="init()" class="bg-slate-50 min-h-screen flex flex-col items-center md:justify-center py-6 px-4 relative overflow-x-hidden selection:bg-rose-500 selection:text-white">

    <div class="absolute top-0 left-0 w-80 h-80 bg-purple-300 rounded-full mix-blend-multiply filter blur-3xl opacity-30 animate-blob pointer-events-none"></div>
    <div class="absolute top-0 right-0 w-80 h-80 bg-yellow-300 rounded-full mix-blend-multiply filter blur-3xl opacity-30 animate-blob animation-delay-2000 pointer-events-none"></div>
    <div class="absolute -bottom-32 left-20 w-80 h-80 bg-pink-300 rounded-full mix-blend-multiply filter blur-3xl opacity-30 animate-blob animation-delay-4000 pointer-events-none"></div>

    <div class="absolute top-4 right-4 z-50">
        <template x-if="!user">
            <button @click="showLoginModal = true" class="group flex items-center gap-2 bg-white/60 hover:bg-white backdrop-blur-md border border-white/50 px-4 py-2 rounded-full shadow-sm hover:shadow-md transition-all duration-300">
                <span class="w-8 h-8 rounded-full bg-slate-200 flex items-center justify-center text-slate-500 group-hover:bg-rose-100 group-hover:text-rose-500 transition-colors">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                    </svg>
                </span>
                <span class="text-xs md:text-sm font-bold text-slate-600 group-hover:text-slate-900">ç™»å½•è´¦å·</span>
            </button>
        </template>

        <template x-if="user">
            <div class="flex items-center gap-2">
                <div class="flex items-center gap-2 bg-white/80 backdrop-blur-md border border-white/50 px-4 py-2 rounded-full shadow-sm">
                    <span class="w-2 h-2 rounded-full bg-green-500 animate-pulse"></span>
                    <span class="text-xs md:text-sm font-bold text-slate-700" x-text="getUserName()"></span>
                </div>
                <button @click="logout()" class="w-8 h-8 md:w-auto md:h-auto md:px-3 md:py-2 flex items-center justify-center bg-slate-200 hover:bg-rose-100 text-slate-500 hover:text-rose-600 rounded-full md:rounded-xl transition-colors" title="é€€å‡ºç™»å½•">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1" />
                    </svg>
                    <span class="hidden md:inline ml-1 text-xs font-bold">é€€å‡º</span>
                </button>
            </div>
        </template>
    </div>

    <div x-show="showLoginModal" class="fixed inset-0 z-[60] flex items-center justify-center px-4" x-cloak>
        <div class="absolute inset-0 bg-slate-900/60 backdrop-blur-sm" @click="showLoginModal = false" 
             x-transition:enter="transition ease-out duration-300" x-transition:enter-start="opacity-0" x-transition:enter-end="opacity-100"
             x-transition:leave="transition ease-in duration-200" x-transition:leave-start="opacity-100" x-transition:leave-end="opacity-0"></div>
        
        <div class="bg-white w-full max-w-sm rounded-3xl shadow-2xl overflow-hidden relative z-10 p-8"
             x-transition:enter="transition ease-out duration-300" x-transition:enter-start="opacity-0 scale-95 translate-y-4" x-transition:enter-end="opacity-100 scale-100 translate-y-0">
            
            <button @click="showLoginModal = false" class="absolute top-4 right-4 text-slate-400 hover:text-slate-800 transition-colors">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
            </button>

            <div class="text-center mb-6">
                <h2 class="text-2xl font-black text-slate-800" x-text="isRegisterMode ? 'åˆ›å»ºè´¦å·' : 'æ¬¢è¿å›æ¥'"></h2>
                <p class="text-sm text-slate-500 font-bold mt-1">Sydney Life Hub</p>
            </div>

            <form class="space-y-4" @submit.prevent="handleAuth">
                <div>
                    <label class="block text-xs font-bold text-slate-500 uppercase mb-1 ml-1">é‚®ç®±</label>
                    <input type="email" x-model="email" required placeholder="name@example.com" class="w-full px-4 py-3 rounded-xl bg-slate-50 border border-slate-200 focus:border-rose-400 focus:ring-0 outline-none transition-colors font-bold text-slate-700 text-sm">
                </div>
                <div>
                    <label class="block text-xs font-bold text-slate-500 uppercase mb-1 ml-1">å¯†ç </label>
                    <input type="password" x-model="password" required minlength="6" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢" class="w-full px-4 py-3 rounded-xl bg-slate-50 border border-slate-200 focus:border-rose-400 focus:ring-0 outline-none transition-colors font-bold text-slate-700 text-sm">
                </div>
                
                <div x-show="errorMsg" class="text-red-500 text-xs font-bold text-center" x-text="errorMsg"></div>

                <button type="submit" :disabled="loading" class="w-full py-3.5 bg-slate-900 hover:bg-rose-500 disabled:bg-slate-400 text-white rounded-xl font-bold shadow-lg shadow-rose-200 transition-all duration-300 transform active:scale-95 flex justify-center items-center">
                    <span x-show="loading" class="animate-spin mr-2">â³</span>
                    <span x-text="loading ? 'å¤„ç†ä¸­...' : (isRegisterMode ? 'ç«‹å³æ³¨å†Œ' : 'ç™» å½•')"></span>
                </button>
            </form>

            <div class="mt-6 text-center">
                <p class="text-xs font-bold text-slate-400">
                    <span x-text="isRegisterMode ? 'å·²æœ‰è´¦å·ï¼Ÿ' : 'è¿˜æ²¡æœ‰è´¦å·ï¼Ÿ'"></span>
                    <button @click="toggleMode()" class="text-rose-500 hover:text-rose-600 ml-1 underline underline-offset-2">
                        <span x-text="isRegisterMode ? 'å»ç™»å½•' : 'å…è´¹æ³¨å†Œ'"></span>
                    </button>
                </p>
            </div>
        </div>
    </div>

    <main class="max-w-6xl w-full z-10 relative">
        <div class="text-center mb-6 md:mb-16 space-y-2 md:space-y-4">
            <h1 class="text-4xl md:text-7xl font-black text-slate-800 tracking-tighter drop-shadow-sm">Sydney Life Hub</h1>
            <div class="inline-block px-3 py-1 md:px-4 md:py-1.5 rounded-full bg-white/60 backdrop-blur-sm border border-white/50 shadow-sm">
                <p class="text-xs md:text-base text-slate-600 font-bold tracking-widest uppercase">YANGSCAPE â€¢ æ‚‰å°¼ç”Ÿæ´»æŒ‡å—</p>
            </div>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 md:gap-10 px-0 md:px-4">
            <a href="dining.html" class="group relative h-52 md:h-96 rounded-[2rem] md:rounded-[2.5rem] overflow-hidden shadow-xl md:shadow-2xl transition-all duration-500 hover:-translate-y-1 md:hover:-translate-y-3 cursor-pointer ring-2 md:ring-4 ring-transparent hover:ring-rose-100">
                <div class="absolute inset-0 bg-gradient-to-br from-[#FF9A9E] via-[#FECFEF] to-[#FFB6C1] transition-transform duration-700 group-hover:scale-110"></div>
                <div class="absolute inset-0 p-5 md:p-8 flex flex-col justify-between items-center text-center">
                    <div class="w-12 h-12 text-2xl md:w-20 md:h-20 md:text-4xl bg-white/80 rounded-2xl md:rounded-3xl flex items-center justify-center shadow-lg backdrop-blur-md group-hover:scale-110 group-hover:rotate-6 transition-all duration-300">ğŸ½ï¸</div>
                    <div class="space-y-0.5 md:space-y-1"><h2 class="text-2xl md:text-3xl font-black text-slate-900 drop-shadow-sm">æ‚‰å°¼åƒä»€ä¹ˆ</h2><p class="text-[10px] md:text-xs font-bold text-slate-700/60 uppercase tracking-widest">Food Guide</p></div>
                    <div class="w-full space-y-2 md:space-y-4"><p class="text-slate-800 text-xs md:text-sm font-bold opacity-90 md:opacity-80 group-hover:opacity-100 transition-opacity leading-relaxed line-clamp-1 md:line-clamp-none">è§£å†³ç¾é£Ÿè’æ¼ çš„é€‰æ‹©å›°éš¾ç—‡</p><span class="flex items-center justify-center w-full py-2 md:py-3.5 bg-black/90 text-white rounded-xl md:rounded-2xl font-bold text-xs md:text-sm group-hover:bg-black transition-colors shadow-lg">å¼€å§‹æ¢ç´¢</span></div>
                </div>
            </a>

            <a href="places.html" class="group relative h-52 md:h-96 rounded-[2rem] md:rounded-[2.5rem] overflow-hidden shadow-xl md:shadow-2xl transition-all duration-500 hover:-translate-y-1 md:hover:-translate-y-3 cursor-pointer ring-2 md:ring-4 ring-transparent hover:ring-sky-100">
                <div class="absolute inset-0 bg-gradient-to-br from-[#E0F2F1] via-[#B2EBF2] to-[#4DD0E1] transition-transform duration-700 group-hover:scale-110"></div>
                <div class="absolute inset-0 p-5 md:p-8 flex flex-col justify-between items-center text-center">
                    <div class="w-12 h-12 text-2xl md:w-20 md:h-20 md:text-4xl bg-white/80 rounded-2xl md:rounded-3xl flex items-center justify-center shadow-lg backdrop-blur-md group-hover:scale-110 group-hover:-rotate-6 transition-all duration-300">ğŸï¸</div>
                    <div class="space-y-0.5 md:space-y-1"><h2 class="text-2xl md:text-3xl font-black text-slate-900 drop-shadow-sm">æ‚‰å°¼å»å“ªé‡Œ</h2><p class="text-[10px] md:text-xs font-bold text-slate-700/60 uppercase tracking-widest">Trip Guide</p></div>
                    <div class="w-full space-y-2 md:space-y-4"><p class="text-slate-800 text-xs md:text-sm font-bold opacity-90 md:opacity-80 group-hover:opacity-100 transition-opacity leading-relaxed line-clamp-1 md:line-clamp-none">å‘ç°å‘¨è¾¹çš„å°ä¼—ä¸çƒ­é—¨æ™¯ç‚¹</p><span class="flex items-center justify-center w-full py-2 md:py-3.5 bg-slate-900/90 text-white rounded-xl md:rounded-2xl font-bold text-xs md:text-sm group-hover:bg-slate-900 transition-colors shadow-lg">å¯»æ‰¾çµæ„Ÿ</span></div>
                </div>
            </a>

            <a href="hospital.html" class="group relative h-52 md:h-96 rounded-[2rem] md:rounded-[2.5rem] overflow-hidden shadow-xl md:shadow-2xl transition-all duration-500 hover:-translate-y-1 md:hover:-translate-y-3 cursor-pointer ring-2 md:ring-4 ring-transparent hover:ring-teal-100">
                <div class="absolute inset-0 bg-gradient-to-br from-[#F0F9FF] via-[#E0F2FE] to-[#99F6E4] transition-transform duration-700 group-hover:scale-110"></div>
                <div class="absolute inset-0 p-5 md:p-8 flex flex-col justify-between items-center text-center">
                    <div class="w-12 h-12 text-2xl md:w-20 md:h-20 md:text-4xl bg-white/80 rounded-2xl md:rounded-3xl flex items-center justify-center shadow-lg backdrop-blur-md group-hover:scale-110 group-hover:rotate-6 transition-all duration-300">ğŸ¥</div>
                    <div class="space-y-0.5 md:space-y-1"><h2 class="text-2xl md:text-3xl font-black text-slate-900 drop-shadow-sm">åŒ»é™¢æŒ‡å—</h2><p class="text-[10px] md:text-xs font-bold text-slate-700/60 uppercase tracking-widest">Health Guide</p></div>
                    <div class="w-full space-y-2 md:space-y-4"><p class="text-slate-800 text-xs md:text-sm font-bold opacity-90 md:opacity-80 group-hover:opacity-100 transition-opacity leading-relaxed line-clamp-1 md:line-clamp-none">å…¨æ‚‰å°¼å…¬ç«‹ã€ç§ç«‹ä¸æ€¥è¯Šç´¢å¼•</p><span class="flex items-center justify-center w-full py-2 md:py-3.5 bg-slate-900/90 text-white rounded-xl md:rounded-2xl font-bold text-xs md:text-sm group-hover:bg-slate-900 transition-colors shadow-lg">æŸ¥è¯¢åŒ»é™¢</span></div>
                </div>
            </a>
        </div>

        <footer class="mt-8 md:mt-20 text-center pb-4">
            <div class="inline-flex items-center gap-2 px-3 py-1.5 md:px-4 md:py-2 rounded-full bg-slate-200/50 text-slate-500 text-[10px] md:text-xs font-bold hover:bg-white hover:shadow-sm transition-all cursor-default">
                <span>Â© 2025 Yangscape Series</span><span class="w-1 h-1 rounded-full bg-slate-400"></span><span>Designed for Yang Hao</span>
            </div>
        </footer>
    </main>

    <script>
        // é…ç½® Supabase (ä½¿ç”¨æ‚¨çš„é¡¹ç›®é…ç½®)
        const SUPABASE_URL = 'https://ggnqbroahaggwttkhnwe.supabase.co';
        const SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImdnbnFicm9haGFnZ3d0dGtobndlIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjU4NzM2MjEsImV4cCI6MjA4MTQ0OTYyMX0.T0TS44LkY15MBa2wWqECC0nbDro0DICGBluSWFh6HrA';
        const supabaseClient = supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

        function authApp() {
            return {
                user: null,
                showLoginModal: false,
                isRegisterMode: false,
                email: '',
                password: '',
                loading: false,
                errorMsg: '',

                async init() {
                    // 1. æ£€æŸ¥å½“å‰ä¼šè¯
                    const { data: { session } } = await supabaseClient.auth.getSession();
                    this.user = session?.user || null;

                    // 2. ç›‘å¬ç™»å½•çŠ¶æ€å˜åŒ– (ç™»å½•/é€€å‡ºæ—¶è‡ªåŠ¨æ›´æ–° UI)
                    supabaseClient.auth.onAuthStateChange((_event, session) => {
                        this.user = session?.user || null;
                    });
                },

                toggleMode() {
                    this.isRegisterMode = !this.isRegisterMode;
                    this.errorMsg = '';
                },

                async handleAuth() {
                    this.loading = true;
                    this.errorMsg = '';
                    
                    try {
                        if (this.isRegisterMode) {
                            // --- æ³¨å†Œé€»è¾‘ ---
                            const { data, error } = await supabaseClient.auth.signUp({
                                email: this.email,
                                password: this.password,
                            });
                            if (error) throw error;
                            alert('æ³¨å†ŒæˆåŠŸï¼å¦‚æœæœªè‡ªåŠ¨ç™»å½•ï¼Œè¯·æ£€æŸ¥æ‚¨çš„é‚®ç®±è¿›è¡ŒéªŒè¯ã€‚');
                            this.showLoginModal = false;
                        } else {
                            // --- ç™»å½•é€»è¾‘ ---
                            const { data, error } = await supabaseClient.auth.signInWithPassword({
                                email: this.email,
                                password: this.password,
                            });
                            if (error) throw error;
                            // ç™»å½•æˆåŠŸï¼Œå¼¹çª—ä¼šè‡ªåŠ¨å…³é—­ (é€šè¿‡ onAuthStateChange)
                            this.showLoginModal = false;
                            this.email = '';
                            this.password = '';
                        }
                    } catch (err) {
                        console.error(err);
                        this.errorMsg = err.message === 'Invalid login credentials' ? 'è´¦å·æˆ–å¯†ç é”™è¯¯' : err.message;
                    } finally {
                        this.loading = false;
                    }
                },

                async logout() {
                    if(!confirm('ç¡®å®šè¦é€€å‡ºç™»å½•å—ï¼Ÿ')) return;
                    await supabaseClient.auth.signOut();
                },

                getUserName() {
                    if (!this.user || !this.user.email) return 'User';
                    return this.user.email.split('@')[0]; // æ˜¾ç¤ºé‚®ç®±å‰ç¼€
                }
            }
        }
    </script>
</body>
</html>
